<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>JW Tools</title>
  <meta http-equiv="Content-Security-Policy" content="script-src 'self' 'unsafe-inline';">
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <div class="container">
    <header>
      <!-- Update Notification Banner (hidden by default) -->
      <div id="update-notification" class="update-notification hidden">
        <span id="update-message">An update is available!</span>
        <button id="update-button" class="update-button">Install Update</button>
        <button id="dismiss-update" class="dismiss-button">×</button>
      </div>
      <div class="logo-container">
        <!-- Clickable SVG Logo that links to GitHub repository -->
        <a href="#" id="logo-link" title="Visit GitHub Repository">
          <img src="assets/jw-tools-icon.png" alt="JW Tools Logo" class="logo">
        </a>
      </div>
      <div class="title-container">
        <h1>JW Tools</h1>
        <p>A collection of useful tools</p>
      </div>
      <div class="app-settings-container">
        <button id="app-settings-btn" class="app-settings-button" aria-label="Application Settings">
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <circle cx="12" cy="12" r="3"></circle>
            <path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"></path>
          </svg>
        </button>
      </div>
    </header>
    
    <div class="tools-container">
      <div class="tools-list">
        <h2>Available Tools</h2>
        <ul>
          <li>
            <button id="zoom-attendance-btn" class="tool-button">
              <span class="tool-name">Zoom Attendance Calculator</span>
              <p class="tool-description">Calculate total attendance from Zoom poll results</p>
            </button>
          </li>
          <li>
            <button id="start-zoom-btn" class="tool-button">
              <span class="tool-name">Start Zoom</span>
              <p class="tool-description">Launch Zoom application</p>
            </button>
          </li>
          <li>
            <button id="media-launcher-btn" class="tool-button">
              <span class="tool-name">Media Launcher</span>
              <p class="tool-description">Launch all media presentation tools for hosting</p>
            </button>
          </li>
          <!-- Additional tools will be added here -->
        </ul>
      </div>
      
      <div id="tool-content" class="tool-content">
        <!-- Tool content will be loaded here -->
        <div id="welcome-screen" class="welcome-screen">
          <h2>Welcome to JW Tools</h2>
          <p>Please select a tool from the list to get started.</p>
        </div>
        
        <!-- Zoom Attendance Calculator Tool -->
        <div id="zoom-attendance-calculator" class="tool-panel hidden">
          <div class="tool-header">
            <h2>Zoom Attendance Calculator</h2>
            <button id="help-button" class="help-button" aria-label="Help">?</button>
          </div>
          <div id="help-popup" class="help-popup hidden">
            <p>To use this calculator: <br>1. Set up a poll in Zoom with options labeled as "1", "2", "3", etc. (representing the number of people watching).<br>2. After the meeting, enter the number of responses for each poll option.<br>3. Enter the number of phone connections (each counted as 1 person).<br>4. Click "Calculate" to get the total attendance.</p>
            <button id="close-help" class="close-help">×</button>
          </div>
          <p class="tool-instructions">Enter the number of responses for each poll option, then scroll down and hit calculate:</p>
          
          <form id="attendance-form">
            <div class="form-grid">
              <div class="form-group">
                <label for="option1">1 person:</label>
                <input type="number" id="option1" min="0" value="0" class="number-input">
              </div>
              <div class="form-group">
                <label for="option2">2 people:</label>
                <input type="number" id="option2" min="0" value="0" class="number-input">
              </div>
              <div class="form-group">
                <label for="option3">3 people:</label>
                <input type="number" id="option3" min="0" value="0" class="number-input">
              </div>
              <div class="form-group">
                <label for="option4">4 people:</label>
                <input type="number" id="option4" min="0" value="0" class="number-input">
              </div>
              <div class="form-group">
                <label for="option5">5 people:</label>
                <input type="number" id="option5" min="0" value="0" class="number-input">
              </div>
              <div class="form-group">
                <label for="option6">6 people:</label>
                <input type="number" id="option6" min="0" value="0" class="number-input">
              </div>
              <div class="form-group">
                <label for="option7">7 people:</label>
                <input type="number" id="option7" min="0" value="0" class="number-input">
              </div>
              <div class="form-group">
                <label for="option8">8 people:</label>
                <input type="number" id="option8" min="0" value="0" class="number-input">
              </div>
              <div class="form-group">
                <label for="option9">9 people:</label>
                <input type="number" id="option9" min="0" value="0" class="number-input">
              </div>
              <div class="form-group">
                <label for="option10">10 people:</label>
                <input type="number" id="option10" min="0" value="0" class="number-input">
              </div>
              <div class="form-group">
                <label for="optionPhone">Phone connections:</label>
                <input type="number" id="optionPhone" min="0" value="0" class="number-input">
              </div>
            </div>

            <div class="calculate-container">
              <button type="submit" class="calculate-btn">Calculate</button>
              <br>
              <p class="hint-text">You can also press Enter to calculate</p>
            </div>
          </form>         
        </div>
        
        <!-- Result View -->
        <div id="result-view" class="result-view hidden">
          <div class="result-container">
            <h2>Total Attendance</h2>
            <div id="attendance-result" class="attendance-result">0</div>
          </div>
          <button id="back-button" class="back-button">← Back to Calculator</button>
          <button id="calculate-again-button" class="calculate-again-btn">Calculate Again</button>
        </div>
        
        <!-- Start Zoom Tool -->
        <div id="start-zoom" class="tool-panel hidden">
          <div class="tool-header">
            <h2>Start Zoom</h2>
            <button id="zoom-settings-btn" class="settings-button" aria-label="Settings">
              <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <circle cx="12" cy="12" r="3"></circle>
                <path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"></path>
              </svg>
            </button>
          </div>
          <div class="zoom-content">
            <p class="tool-instructions">Click the button below to launch Zoom:</p>
            <button id="launch-zoom-btn" class="launch-zoom-btn">Launch Zoom</button>
            <p id="zoom-status" class="zoom-status"></p>
          </div>
        </div>
        
        <!-- Media Launcher Tool -->
        <div id="media-launcher" class="tool-panel hidden">
          <div class="tool-header">
            <h2>Zoom Media Launcher</h2>
            <div class="tool-header-buttons">
              <button id="media-help-btn" class="help-button" aria-label="Help">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <circle cx="12" cy="12" r="10"></circle>
                  <path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"></path>
                  <line x1="12" y1="17" x2="12.01" y2="17"></line>
                </svg>
              </button>
              <button id="media-settings-btn" class="settings-button" aria-label="Media Settings">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <circle cx="12" cy="12" r="3"></circle>
                  <path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"></path>
                </svg>
              </button>
            </div>
          </div>
          <div class="media-launcher-content">
            <p class="tool-instructions">Launch all your meeting media tools with one click:</p>
            
            <div class="launch-sequence">
              <ul class="launch-steps">
                <li id="custommsg-step"><span class="step-text">Custom message</span></li>
                <li id="obs-step"><span class="step-text">Launch OBS with virtual camera</span></li>
                <li id="media-manager-step"><span class="step-text">Launch Meeting Media Manager</span></li>
                <li id="zoom-step"><span class="step-text">Launch Zoom</span></li>
              </ul>
            </div>
            
            <button id="launch-media-btn" class="launch-media-btn">Launch Media Tools</button>
            
            <!-- Progress container (hidden by default) -->
            <div id="launch-progress-container" class="launch-progress-container hidden">
              <div class="progress-bar-container">
                <div id="launch-progress-bar" class="progress-bar"></div>
              </div>
              <p id="launch-status" class="launch-status">Preparing to launch...</p>
            </div>
            
            <!-- custommsg popup (hidden by default) -->
            <div id="custommsg-popup" class="custommsg-popup hidden">
              <div class="custommsg-popup-content">
                <h3>Custom Message</h3>
                <p>Your custom message will appear here.</p>
                <p></p>
                <div class="custommsg-popup-progress">
                  <div class="custommsg-popup-progress-bar"></div>
                </div>
              </div>
            </div>
            
            <!-- Media Settings Panel -->
          </div>
        </div>
      </div>
    </div>
  </div>
  
  <!-- Application Settings Popup -->
  <div id="app-settings-popup" class="app-settings-popup hidden">
    <div class="app-settings-content">
      <div class="app-settings-header">
        <h2>Application Settings</h2>
        <button id="close-app-settings" class="close-app-settings">×</button>
      </div>
      <div class="app-settings-body">
        <div class="settings-option">
          <div class="settings-group-title">Window Options</div>
          <div class="checkbox-wrapper">
            <input type="checkbox" id="always-maximize" name="always-maximize">
            <label for="always-maximize">Always Open Maximized</label>
          </div>
          <p class="settings-description">When enabled, the application will always open maximized to fill the screen.</p>
        </div>
        
        <div class="settings-option">
          <div class="settings-group-title">Startup Options</div>
          <label for="default-tool">Default open to tool:</label>
          <select id="default-tool" name="default-tool" class="settings-select">
            <option value="welcome-screen">Welcome Screen</option>
            <option value="zoom-attendance-calculator">Zoom Attendance Calculator</option>
            <option value="start-zoom">Start Zoom</option>
            <option value="media-launcher">Media Launcher</option>
          </select>
          <p class="settings-description">Select which tool should automatically open when the application launches.</p>
        </div>
        
        <div class="settings-option reset-settings-option">
          <div class="settings-group-title">Reset Settings</div>
          <p class="settings-description">Reset all settings for all tools back to their default values.</p>
          <button id="reset-settings-btn" class="reset-settings-btn">Reset to Defaults</button>
          <div id="reset-confirmation" class="reset-confirmation hidden">Double-click to confirm reset</div>
        </div>
      </div>
      <div class="app-settings-footer">
        <button id="save-app-settings" class="save-app-settings">Save Settings</button>
      </div>
    </div>
  </div>
  
  <!-- Media Settings Popup -->
  <div id="media-settings-popup" class="app-settings-popup hidden">
    <div class="app-settings-content">
      <div class="app-settings-header">
        <h2>Media Launcher Settings</h2>
        <button id="close-media-settings-btn" class="close-app-settings">×</button>
      </div>
      <div class="app-settings-body">
        <p>Configure the paths to your media applications:</p>
        
        <div class="settings-option">
          <div class="settings-group-title">OBS Studio</div>
          <button id="browse-obs-path-btn" class="browse-btn">Browse for OBS</button>
          <p id="current-obs-path" class="current-path">Using default path</p>
        </div>
        
        <div class="settings-option">
          <div class="settings-group-title">Meeting Media Manager</div>
          <button id="browse-media-manager-path-btn" class="browse-btn">Browse for Meeting Media Manager</button>
          <p id="current-media-manager-path" class="current-path">Using default path</p>
        </div>
        
        <div class="settings-option">
          <div class="settings-group-title">Zoom</div>
          <button id="browse-media-zoom-path-btn" class="browse-btn">Browse for Zoom</button>
          <p id="current-media-zoom-path" class="current-path">Using default path</p>
        </div>
        
        <div class="settings-option">
          <div class="settings-group-title">Custom Message Settings</div>
          <div class="checkbox-wrapper">
            <input type="checkbox" id="custom-message-enabled" name="custom-message-enabled">
            <label for="custom-message-enabled">Enable Custom Message</label>
          </div>
          <p class="settings-description">When enabled, a custom message will be displayed instead of the default custommsg sync check.</p>
          
          <div id="custom-message-settings" class="custom-message-settings">
            <div class="form-group">
              <label for="custom-message-title">Title:</label>
              <input type="text" id="custom-message-title" class="settings-input" placeholder="Enter custom title">
            </div>
            
            <div class="form-group">
              <label for="custom-message-text">Message:</label>
              <textarea id="custom-message-text" class="settings-textarea" placeholder="Enter custom message text"></textarea>
            </div>
            
            <div class="form-group">
              <label for="custom-message-time">Display Time (seconds):</label>
              <input type="number" id="custom-message-time" class="settings-input" min="1" max="30" value="5">
            </div>
          </div>
        </div>
        
      </div>
      <div class="app-settings-footer">
        <p id="media-settings-status" class="settings-status"></p>
        <button id="save-media-settings-btn" class="save-app-settings">Close</button>
      </div>
    </div>
  </div>
  
  <!-- Media Help Popup -->
  <div id="media-help-popup" class="app-settings-popup hidden">
    <div class="app-settings-content">
      <div class="app-settings-header">
        <h2>Media Launcher Help</h2>
        <button id="close-media-help-btn" class="close-app-settings">×</button>
      </div>
      <div class="app-settings-body">
        <h3>Using the Media Launcher</h3>
        <p>This tool is designed to launch the appropriate applications in the correct order for use with Meeting Media Manager (M³), a powerful media management tool for congregation meetings.</p>
        
        <h3>Resources</h3>
        <ul>
          <li><strong>Meeting Media Manager (M³):</strong> <a href="https://sircharlo.github.io/meeting-media-manager/" class="external-link">https://sircharlo.github.io/meeting-media-manager/</a></li>
          <li><strong>M³ Documentation:</strong> <a href="https://sircharlo.github.io/meeting-media-manager/using-at-a-kingdom-hall" class="external-link">https://sircharlo.github.io/meeting-media-manager/using-at-a-kingdom-hall</a></li>
          <li><strong>OBS Studio:</strong> <a href="https://obsproject.com/download" class="external-link">https://obsproject.com/download</a></li>
          <li><strong>Zoom:</strong> <a href="https://zoom.us/download" class="external-link">https://zoom.us/download</a></li>
        </ul>
        
        <h3>How This Tool Works</h3>
        <p>Our Media Launcher complements M³ by ensuring that OBS Studio, Meeting Media Manager, and Zoom are all launched in the correct sequence, which helps streamline the setup process for congregation meetings.</p>
        <ul>
          <li>Configure the paths to your applications in settings first</li>
          <li>Click "Launch Media Tools" to automatically start all applications in sequence</li>
          <li>Wait for each application to start before the next one launches</li>
        </ul>
        
        <h3>Custom Message Feature</h3>
        <p>The custom message option is particularly useful when you've set up folder monitoring in M³ and are using cloud storage solutions like OneDrive or Google Drive for remote file adding.</p>
        <p>When enabled, this feature displays a customizable popup message that reminds the brother operating the system to allow sufficient time for cloud synchronization before proceeding. This ensures that any media files added remotely have been properly synchronized to the local machine before the meeting begins.</p>
        <p>To configure this feature:</p>
        <ul>
          <li>Enable the Custom Message option in Media Launcher Settings</li>
          <li>Set your preferred title and message text</li>
          <li>Adjust the display time as needed</li>
        </ul>
      </div>
      <div class="app-settings-footer">
        <button id="close-media-help-footer-btn" class="save-app-settings">Close</button>
      </div>
    </div>
  </div>
  
  <!-- Zoom Settings Popup -->
  <div id="zoom-settings-popup" class="app-settings-popup hidden">
    <div class="app-settings-content">
      <div class="app-settings-header">
        <h2>Zoom Settings</h2>
        <button id="close-zoom-settings" class="close-app-settings">×</button>
      </div>
      <div class="app-settings-body">
        <div class="settings-option">
          <div class="settings-group-title">Zoom Application</div>
          <p>Configure the path to your Zoom application:</p>
          <button id="browse-zoom-path-btn" class="browse-btn">Browse for Zoom</button>
          <p id="current-zoom-path" class="current-path">No path configured</p>
        </div>
        
        <div class="settings-option">
          <div class="settings-group-title">Meeting Settings</div>
          <div class="form-group">
            <label for="zoom-meeting-id">Meeting ID:</label>
            <input type="text" id="zoom-meeting-id" class="settings-input" placeholder="Enter your recurring meeting ID">
            <p class="settings-description">Enter the meeting ID for your recurring Zoom meeting. You can enter just the ID (e.g., "1234567890"), ID with password (e.g., "1234567890,password123"), or paste a Zoom meeting URL.</p>
          </div>
        </div>
      </div>
      <div class="app-settings-footer">
        <p id="meeting-id-status" class="settings-status"></p>
        <button id="save-zoom-settings" class="save-app-settings">Save Settings</button>
      </div>
    </div>
  </div>
  
  <script src="renderer.js"></script>
</body>
</html>